<!DOCTYPE html>
<html lang="tr">
	<head>
		<meta charset="UTF-8">
		<meta name="format-detection" content="telephone=no">
		<meta name="msapplication-tap-highlight" content="no">
		<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
		<link rel="stylesheet" type="text/css" href="css/normalize.css">
		<link rel="stylesheet" type="text/css" href="css/formalize.css">
		<link rel="stylesheet" type="text/css" href="css/zerogrid.css">
		<link rel="stylesheet" type="text/css" href="css/index.css">
		<link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.5.min.css">
		<link rel="stylesheet" type="text/css" href="font-awesome/css/font-awesome.min.css">
		<script src="js/jquery-2.1.0.min.js"></script>
		<script src="js/jquery.mobile-1.4.5.min.js"></script>
		<script src="js/index.js"></script>
		<script src="js/qr.js"></script>
		<title>Okan Mekatronik</title>
	</head>
	<body>
		<div data-role="page" data-title="Hesabım" data-quicklinks="true">
			<header>
				<div class="full">
					<div class="row">
						<div class="col-11-sm">
							<h1 class="headerTitle">Hesabım</h1>
						</div>
						<div class="col-1-sm">
							<i id="headerIcon" onclick="window.location.reload()" class="fa fa-refresh" aria-hidden="true"></i>
						</div>
					</div>
				</div>
			</header>

			<article>

				<section id="loginPage" style="display: none">
					<div class="full">
						<div class="row bos35pt">
								<div class="col-12">
									<p style="font-size: 12px;">
										Username
									</p>
									<input type="text" name="username" id="usernameLogin" placeholder="Username">
								</div>
								<div class="col-12">
									<p style="font-size: 12px;">
										Password
									</p>
									<input type="password" name="password" id="passwordLogin" placeholder="Password">
								</div>
								<div class="col-12">
									<button name="Login" id="LoginButton">Login</button>
								</div>
						</div>
					</div>
				</section>

				<section id="registerPage" style="display: none">
					<div class="full">
						<div class="row bos35pt">
							<div class="col-12">
								<p style="font-size: 12px;">
									Username
								</p>
								<input type="text" name="usernameRegister" id="usernameRegister" placeholder="Username">
							</div>
							<div class="col-12">
								<p style="font-size: 12px;">
									Password
								</p>
								<input type="password" name="passwordRegister" id="passwordRegister" placeholder="Password">
							</div>
							<div class="col-12">
								<p style="font-size: 12px;">
									Fullname
								</p>
								<input type="text" name="fullnameRegister" id="fullnameRegister" placeholder="Fullname">
							</div>
							<div class="col-12">
								<p style="font-size: 12px;">
									Email
								</p>
								<input type="email" name="emailRegister" id="emailRegister" placeholder="Email">
							</div>
							<div class="col-12">
								<p style="font-size: 12px;">
									Phone
								</p>
								<input type="text" name="phoneRegister" id="phoneRegister" placeholder="Phone Number">
							</div>
							<div class="col-12">
								<button name="Register" id="RegisterButton">Register</button>
							</div>
						</div>
					</div>
				</section>

				<section id="loginRegister">
					<div class="full">
						<div class="row bos35pt">
							<center>
								<p style="border-bottom: 1px solid #ddd; border-top: 1px solid #ddd; padding-top: 15px; padding-bottom: 15px;">
									<a href="#" id="login">
										Login
									</a>
								</p>
								<p style="border-bottom: 1px solid #ddd; padding-top: 15px; padding-bottom: 15px;">
									<a href="#" id="register">
										Register
									</a>
								</p>
							</center>
						</div>
					</div>
				</section>

				<section id="user" style="display: none;">
					<div class="full">
						<div class="row bos35pt" style="border-bottom: 1px solid #ddd;">
							<div class="col-3-sm">
								<img class="logo-mmyaccount" src="img/logo.png" alt="">
							</div>
							<div class="col-9-sm">
								<p class="myaccount-name" id="fullname" style="text-transform: capitalize;"></p>
							</div>
						</div>

						<div class="row" style="border-bottom: 1px solid #ddd;">
							<div class="col-3-sm">
								<p>Kullanıcı Adı: </p>
							</div>
							<div class="col-9-sm">
								<p style="text-align: right" id="username"></p>
							</div>
						</div>
						<div class="row" style="border-bottom: 1px solid #ddd;">
							<div class="col-3-sm">
								<p>İsim: </p>
							</div>
							<div class="col-9-sm" style="text-transform: capitalize;">
								<p style="text-align: right" id="fullname2"></p>
							</div>
						</div>
						<div class="row" style="border-bottom: 1px solid #ddd; border-top: 1px solid #ddd; padding-top: 15px; padding-bottom: 15px;">
							<div class="col-10-sm">
								<p>
									<a href="qr.html" id="">
										&nbsp; QR Code
									</a>
								</p>
							</div>
							<div class="col-2-sm" id="closeQR" style="display: none">
								<center>
									<i style="font-size: 20px;" class="fa fa-close"></i>
								</center>
							</div>

						</div>

						<div class="row" id="qr" style="display: none;">
							<div class="col-12">
								<center>
									<div id="qrcode"></div>
								</center>
							</div>
						</div>

						<div class="bos35pt"></div>

						<div class="row">
							<p style="font-size: 12px;">
								Okan Mekatronik Kulübü
							</p>
							<center>
								<p style="border-bottom: 1px solid #ddd; border-top: 1px solid #ddd; padding-top: 15px; padding-bottom: 15px;">
									<a href="iframe.html">
										Kulübe Katıl
									</a>
								</p>
								<p style="border-bottom: 1px solid #ddd; border-top: 1px solid #ddd;padding-top: 15px; padding-bottom: 15px;">
									<a href="#popupBasic" data-rel="popup">
										Hakkında
									</a>
								</p>
							</center>
						</div>

						<div data-role="popup" id="popupBasic">
							<p style="padding-top: 10px; padding-bottom: 10px;padding-left: 10px;padding-right: 10px; font-size: 18px;">Okan Üniversitesi Mekatronik Kulübü tarafından ikinci kez düzenlenecek olan Robokan'17 Yarışması Dünyanın dört bir yanından öğrencilerin ve meraklıların katılabileceği bir uluslararası robot yarışmasıdır.</p>
						</div>

						<div class="bos35pt"></div>

						<div class="row">
							<p style="font-size: 12px;">
								Actions
							</p>
							<center>
								<p style="border-bottom: 1px solid #ddd; border-top: 1px solid #ddd; padding-top: 15px; padding-bottom: 15px;">
									<a href="changePass.html">
										Şifremi Değiştir
									</a>
								</p>
								<p style="border-bottom: 1px solid #ddd; border-top: 1px solid #ddd;padding-top: 15px; padding-bottom: 15px;">
									<a href="" id="Cikis">
										Çıkış Yap
									</a>
								</p>
							</center>
						</div>

						<div class="bos35pt"></div>

				</section>
			</article>
		</div>



		<script>

            $(document).ready(function(){

                var loadMyAccountData = localStorage.setItem("loadMyAccountData", 0);
                if (loadMyAccountData == 0){
                    localStorage.setItem("loadMyAccountData", 1);
                    location.reload();
				}


                $("#RegisterButton").click(function(){
                    var username2 = $('#usernameRegister').val();
                    var password2 = $('#passwordRegister').val();
                    var fullname2 = $('#fullnameRegister').val();
                    var phone2 = $('#phoneRegister').val();
                    var email2 = $('#emailRegister').val();
                    $.post("https://api.mekatrotekno.com/login/newUser",
                        {
                            username: username2,
                            password: password2,
                            fullname: fullname2,
							phone: phone2,
                            email: email2

                        },
                        function(data3,status){
                            console.log(data3);
                            console.log(status + " Token");
                            //localStorage.setItem("loginData", JSON.stringify(data));
                            localStorage.setItem("token", JSON.stringify(data3["token"]["token"]));

                        });
                    //var token = JSON.parse(localStorage.getItem("token"));

                    //var okeyy = "blabla";

                    setTimeout(function(){
                        location.reload();
                    }, 1000);

                });



                var OKEY = JSON.parse(localStorage.getItem("token"));

                if (OKEY == null){

                    $("#loginRegister").show();
                    $("#user").hide();

                    $("#login").click(function () {
                        $("#registerPage").hide();
                        $("#loginPage").show("slow");
                    });

                    $("#register").click(function () {
                        $("#loginPage").hide();
                        $("#registerPage").show("slow");
                    });

                    $("#LoginButton").click(function(){
                        var username = $('#usernameLogin').val();
                        var password = $('#passwordLogin').val();
                        //alert(username + " " + password);
                        $.post("https://api.mekatrotekno.com/login/login",
                            {
                                username: username,
                                password: password
                            },
                            function(data,status){
                                //console.log(data);
                                console.log(status + " Token");
                                //localStorage.setItem("loginData", JSON.stringify(data));
                                localStorage.setItem("token", JSON.stringify(data["token"]["token"]));

                            });
                        var token = JSON.parse(localStorage.getItem("token"));

                        var okeyy = "blabla";

                        setTimeout(function(){
                            location.reload();
                        }, 1000);
                    });



                }else{

                    var fullname = JSON.parse(localStorage.getItem("fullname"));
                    var username = JSON.parse(localStorage.getItem("username"));

                    if (fullname == null && username == null){

                        $.post("https://api.mekatrotekno.com/login/info",
                            {
                                token: OKEY
                            },
                            function(dataa,status){
                                //console.log(dataa);
                                console.log(status + " My Data");
                                //localStorage.setItem("myData", JSON.stringify(dataa));
                                localStorage.setItem("fullname", JSON.stringify(dataa["user"]["fullname"]));
                                localStorage.setItem("username", JSON.stringify(dataa["user"]["username"]));
                            });

                        setTimeout(function(){
                            location.reload();
                        }, 1000);
                    }

                    $("#fullname").text(fullname);
                    $("#fullname2").text(fullname);
                    $("#username").text(username);

                    $("#Hakkinda").click(function () {
                        alert("Okan Üniversitesi Mekatronik Kulübü tarafından ikinci kez düzenlenecek olan Robokan'17 Yarışması Dünyanın dört bir yanından öğrencilerin ve meraklıların katılabileceği bir uluslararası robot yarışmasıdır");
                    });

                    $("#Cikis").click(function () {
                        localStorage.clear();
                        location.reload();
                    });

                    var qrcode = new QRCode("qrcode");
                    function makeCode () {
                        qrcode.makeCode("okanmekatronik://"+ username +"/");
                    } makeCode();

                    $("#generate").click(function() {
                        $("#qr").toggle("slow");
                        $("#closeQR").show("slow");
                    });

                    $("#closeQR").click(function() {
                        $("#qr").hide("slow");
                        $("#closeQR").hide("slow");
                    });


                    $("#user").show();
                    $("#loginRegister").hide();
                    $("#loginPage").hide();
                    $("#registerPage").hide();
				}

            });
		</script>

		<div data-role="footer" data-position="fixed" data-theme="a" data-tap-toggle="false">
			<div style="border: none!important;" data-role="navbar" style="background-color: #fbfbfb!important;">
				<ul style="border: none!important;">
					<li style="border: none!important;"><a style="border: none!important;" href="index.html"  data-prefetch="true" data-transition="fade">
						<i class="fa fa-newspaper-o" style="font-size: 25px;"></i>
						<p style="font-size: 10px;">Haberler</p>
					</a></li>
					<li style="border: none!important;"><a style="border: none!important;" href="events.html"  data-prefetch="true" data-transition="fade">
						<i class="fa fa-file-text-o" style="font-size: 25px;"></i>
						<p style="font-size: 10px;">Etkinlikler</p>
					</a></li>
					<li style="border: none!important;"><a style="border: none!important;" href="contact.html"  data-prefetch="true"  class="ui-btn-active" data-transition="fade">
						<i class="fa fa-map-marker" style="font-size: 25px;"></i>
						<p style="font-size: 10px;">İletişim</p>
					</a></li>
					<li style="border: none!important;"><a style="border: none!important;" href="myaccount.html"  data-prefetch="true" data-transition="fade">
						<i class="fa fa-user-o" style="font-size: 25px;"></i>
						<p style="font-size: 10px;" onclick="reloadPage()">Hesabım</p>
					</a></li>
				</ul>
			</div><!-- /navbar -->
		</div><!-- /footer -->
	</body>
</html>